#!/bin/bash

#Capabilities
printf "Capabilities\n"
cap=$(kubectl -n $1 exec -it $2 -c $3 --  /bin/sh -c 'cat /proc/1/status' | grep -i 'CapEff' | awk '{print $2}')
#echo $cap
capsh --decode=$cap
printf "\nAllowPrivilegeEscalation\n"
#AllowPrivilegeEscalation
kubectl -n $1 exec -it $2 -c $3 --  /bin/sh -c 'cat /proc/1/status' | grep -i 'nonewpriv'
printf "\nReadOnlyRootFilesystem\n"
#readOnlyRootFilesystem
kubectl -n $1 exec -it $2 -c $3 --  /bin/sh -c 'cat /proc/mounts' | grep -i 'rw'
printf "\nRunning as root?\n"
#Non root user/ uid > 10000
kubectl -n $1 exec -it $2 -c $3 --  /bin/sh -c 'id'
#SeLinux 
printf "\nselinux?\n"
kubectl -n $1 exec -it $2 -c $3 --  /bin/sh -c 'ls -alZ /tmp'
kubectl -n $1 exec -it $2 -c $3 --  /bin/sh -c 'cat /etc/selinux/config'
