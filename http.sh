#!/bin/bash
if [ -d "$(pwd)/$1" ] 
then
	    cd $1 
    else
	        mkdir $1 && cd $1
fi
echo $(pwd)
hping3 $1 -p $2 -S --tcp-timestamp -c 5 | tee time-stamp_$1_$2_hping3.txt
nmap $1 -p $2 -Pn -sS --script=asn-query -T5 -vvv -oN nmap_$1_$2_asn-query.txt
#dns-brute (only works if we have domain name)
#nmap $1 -p $2 -Pn -sS --script=dns-brute -T5 -vvv -oN nmap_dns-brute.txt
nmap $1 -p $2 -Pn -sS --script=http-date -sV --version-all -T5 -vvv -oN nmap_$1_$2_http-date.txt
nmap $1 -p $2 -Pn -sS --script=http-methods -sV --version-all -T5 -vvv -oN nmap_$1_$2_http-methods.txt
nmap $1 -p $2 -Pn -sS --script=http-security-headers -sV --version-all -T5 -vvv -oN nmap_$1_$2_http-security-headers.txt
#nmap $1 -p $2 -Pn -sS --script=http-waf-detect,http-waf-fingerprint --script-args="http-waf-detect.aggro,http-waf-detect.detectBodyChanges,http-waf-fingerprint.intensive=1" -sV --version-all -T5 -vvv -oN nmap_$1_$2_http-waf-detect.txt
wafw00f http://$1:$2/ -o wafw00f_$1_$2.txt
nikto -C all -maxtime=400s -host http://$1:$2/ | tee nikto$1_$2.txt
whois $1 | tee whois_$1.txt
dirsearch -u http://$1:$2/ -o $(pwd)/dirsearch_$1_$2.txt
nmap -Pn -sS -p $2 -vv --script http-slowloris-check $1
echo "Please run DOS test cases seperatly!"